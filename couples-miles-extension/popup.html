<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Couples Miles</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <img src="icons/icon48.png" alt="Couples Miles" class="logo-icon">
        <div class="logo-text">
          <span class="logo-title">Couples Miles</span>
          <span class="logo-subtitle" data-i18n="secureSync">Sincroniza√ß√£o Segura</span>
        </div>
      </div>
    </header>

    <!-- Consent Modal -->
    <div id="consent-modal" class="modal hidden">
      <div class="modal-content">
        <h2 data-i18n="privacyTitle">üîí Termos de Privacidade</h2>
        <div class="consent-text">
          <p><strong data-i18n="collectsOnly">Esta extens√£o coleta apenas:</strong></p>
          <ul>
            <li>‚úÖ <span data-i18n="collectsMilesBalance">Saldo de milhas vis√≠vel na tela</span></li>
            <li>‚úÖ <span data-i18n="collectsProgramName">Nome do programa</span></li>
            <li>‚úÖ <span data-i18n="collectsSyncDate">Data/hora da sincroniza√ß√£o</span></li>
          </ul>
          <p><strong data-i18n="doesNotTitle">Esta extens√£o N√ÉO:</strong></p>
          <ul>
            <li>‚ùå <span data-i18n="doesNotPasswords">Armazena senhas</span></li>
            <li>‚ùå <span data-i18n="doesNotCredentials">Intercepta credenciais</span></li>
            <li>‚ùå <span data-i18n="doesNotCookies">Acessa cookies de login</span></li>
            <li>‚ùå <span data-i18n="doesNotAutoLogin">Faz login autom√°tico</span></li>
          </ul>
          <p class="consent-note" data-i18n="consentNote">
            A extra√ß√£o s√≥ ocorre ap√≥s seu clique manual e login no site oficial.
          </p>
        </div>
        <button id="accept-consent" class="btn btn-primary" data-i18n="acceptTerms">
          Aceito os Termos
        </button>
      </div>
    </div>

    <!-- Login Section -->
    <div id="login-section" class="section hidden">
      <div class="info-card warning">
        <span class="icon">üîë</span>
        <div>
          <strong data-i18n="loginRequired">Login necess√°rio</strong>
          <p data-i18n="loginDescription">Fa√ßa login no Couples para sincronizar suas milhas.</p>
        </div>
      </div>
      <div class="login-form">
        <input type="email" id="email-input" data-i18n-placeholder="email" placeholder="Email" class="input">
        <input type="password" id="password-input" data-i18n-placeholder="password" placeholder="Senha" class="input">
        <button id="login-btn" class="btn btn-primary" data-i18n="login">
          Entrar
        </button>
        <p class="login-help">
          <a href="https://app.couplesfinancials.com" target="_blank" data-i18n="createAccount">
            Criar conta no Couples
          </a>
        </p>
      </div>
    </div>

    <!-- Main Section -->
    <div id="main-section" class="section hidden">
      <!-- Status do Site Atual -->
      <div id="site-status" class="status-card">
        <div class="status-header">
          <span id="program-icon" class="program-icon">‚úàÔ∏è</span>
          <div class="status-info">
            <span id="program-name" class="program-name">-</span>
            <span id="site-domain" class="site-domain">-</span>
          </div>
          <span id="status-badge" class="badge">-</span>
        </div>
      </div>

      <!-- A√ß√£o Principal -->
      <div id="action-section" class="action-section">
        <button id="sync-btn" class="btn btn-sync" disabled>
          <span class="sync-icon">üîÑ</span>
          <span class="sync-text" data-i18n="syncMiles">Sincronizar Milhas</span>
        </button>
        
        <!-- Status Feedback -->
        <div id="status-feedback" class="status-feedback hidden">
          <span id="status-icon" class="status-icon">‚è≥</span>
          <span id="status-text" class="status-text" data-i18n="statusIdle">Pronto para sincronizar.</span>
        </div>
        
        <p id="action-message" class="action-message"></p>
      </div>

      <!-- Se√ß√£o de Confirma√ß√£o (Fluxo H√≠brido) -->
      <div id="confirmation-section" class="confirmation-section hidden">
        <div class="confirmation-card">
          <div class="confirmation-header">
            <span class="confirmation-icon">üéØ</span>
            <span class="confirmation-title" data-i18n="balanceDetected">Saldo Detectado</span>
          </div>
          <div class="confirmation-value">
            <span id="detected-balance" class="detected-balance">0</span>
            <span class="detected-unit" data-i18n="miles">milhas</span>
          </div>
          <p class="confirmation-question" data-i18n="isThisCorrect">Este valor est√° correto?</p>
          <div class="confirmation-buttons">
            <button id="confirm-yes-btn" class="btn btn-success" data-i18n="yesSend">
              ‚úÖ Sim, enviar
            </button>
            <button id="confirm-no-btn" class="btn btn-secondary" data-i18n="no">
              ‚ùå N√£o
            </button>
          </div>
        </div>
      </div>

      <!-- Se√ß√£o de Retry (quando confirma√ß√£o falha) -->
      <div id="retry-section" class="retry-section hidden">
        <div class="info-card warning">
          <span class="icon">‚ö†Ô∏è</span>
          <div>
            <strong data-i18n="tryAgain">Vamos tentar novamente</strong>
            <p data-i18n="tryAgainDescription">Abra a p√°gina onde seu saldo esteja vis√≠vel e clique novamente em sincronizar.</p>
          </div>
        </div>
        <button id="retry-sync-btn" class="btn btn-primary" data-i18n="tryAgainButton">
          üîÑ Tentar Novamente
        </button>
      </div>

      <!-- Se√ß√£o Not Found (saldo n√£o encontrado) -->
      <div id="not-found-section" class="not-found-section hidden">
        <div class="info-card warning">
          <span class="icon">üîç</span>
          <div>
            <strong data-i18n="balanceNotFound">Saldo n√£o encontrado nesta p√°gina</strong>
            <p data-i18n="balanceNotFoundDescription">Navegue at√© onde seu saldo de milhas esteja vis√≠vel e clique em "Tentar Novamente".</p>
          </div>
        </div>
        <button id="retry-here-btn" class="btn btn-primary" data-i18n="tryAgainHere">
          üîÑ Tentar Novamente (nesta p√°gina)
        </button>
        <button id="go-to-miles-btn" class="btn btn-secondary" data-i18n="goToMilesPage">
          üîó Ir para p√°gina de milhas
        </button>
      </div>

      <!-- Resultado -->
      <div id="result-section" class="result-section hidden">
        <div class="result-card success">
          <span class="result-icon">‚úÖ</span>
          <div class="result-info">
            <span class="result-title" data-i18n="synced">Sincronizado!</span>
            <span id="result-balance" class="result-balance">0 milhas</span>
          </div>
        </div>
      </div>

      <!-- Hist√≥rico R√°pido -->
      <div id="history-section" class="history-section">
        <h3 data-i18n="supportedPrograms">Programas Suportados</h3>
        <div class="programs-list">
          <div class="program-item">
            <span class="program-logo latam">LP</span>
            <span>LATAM Pass</span>
          </div>
          <div class="program-item">
            <span class="program-logo azul">AZ</span>
            <span>Azul Fidelidade</span>
          </div>
          <div class="program-item">
            <span class="program-logo smiles">SM</span>
            <span>Smiles</span>
          </div>
          <div class="program-item">
            <span class="program-logo livelo">LV</span>
            <span>Livelo</span>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="footer">
        <button id="logout-btn" class="btn btn-link" data-i18n="logout">
          Sair
        </button>
        <span class="version">v2.1.0</span>
      </footer>
    </div>

    <!-- Not Supported Section -->
    <div id="not-supported-section" class="section hidden">
      <div class="info-card">
        <span class="icon">‚ÑπÔ∏è</span>
        <div>
          <strong data-i18n="unsupportedSite">Site n√£o suportado</strong>
          <p data-i18n="unsupportedSiteDescription">Acesse um dos sites de milhagem suportados para sincronizar.</p>
        </div>
      </div>
      <div class="programs-list compact">
        <a href="https://www.latamairlines.com/br/pt/minha-conta" target="_blank" class="program-link">
          <span class="program-logo latam">LP</span>
          LATAM Pass
        </a>
        <a href="https://www.voeazul.com.br/home/br/pt/home" target="_blank" class="program-link">
          <span class="program-logo azul">AZ</span>
          Azul Fidelidade
        </a>
        <a href="https://www.smiles.com.br/minha-conta" target="_blank" class="program-link">
          <span class="program-logo smiles">SM</span>
          Smiles
        </a>
        <a href="https://www.livelo.com.br/minha-conta" target="_blank" class="program-link">
          <span class="program-logo livelo">LV</span>
          Livelo
        </a>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
